(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{210:function(a,r,t){"use strict";t.r(r);var e=t(0),i=Object(e.a)({},function(){var a=this,r=a.$createElement,t=a._self._c||r;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"跨域"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#跨域","aria-hidden":"true"}},[a._v("#")]),a._v(" 跨域")]),a._v(" "),t("h2",{attrs:{id:"同源策略"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#同源策略","aria-hidden":"true"}},[a._v("#")]),a._v(" 同源策略")]),a._v(" "),t("p",[a._v("浏览器为保护用户信息安全的策略，必须协议、域名、端口都相同才是同源，否则为非同源，也称跨域。")]),a._v(" "),t("h2",{attrs:{id:"跨域限制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#跨域限制","aria-hidden":"true"}},[a._v("#")]),a._v(" 跨域限制")]),a._v(" "),t("p",[a._v("浏览器一般对跨域行为作如下限制")]),a._v(" "),t("ul",[t("li",[a._v("ajax请求无法读取返回结果")]),a._v(" "),t("li",[a._v("cookie、localstorage无法读取")]),a._v(" "),t("li",[a._v("iframe的dom内容无法获取")]),a._v(" "),t("li",[a._v("外域script标签的错误内容无法被window.onerror捕获")])]),a._v(" "),t("h2",{attrs:{id:"应对方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#应对方法","aria-hidden":"true"}},[a._v("#")]),a._v(" 应对方法")]),a._v(" "),t("h3",{attrs:{id:"ajax请求无法读取返回结果"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ajax请求无法读取返回结果","aria-hidden":"true"}},[a._v("#")]),a._v(" ajax请求无法读取返回结果")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("CORS，在服务端设置返回http的header设置"),t("code",[a._v("Access-Control-Allow-Origin")]),a._v("为"),t("code",[a._v("*")]),a._v("或者本站域名")])]),a._v(" "),t("li",[t("p",[a._v("JSONP，利用script标签无跨域限制的特性，新建script标签，src后面加上回调函数名，服务端把返回结果包装成"),t("code",[a._v("callback(data)")]),a._v("的形式返回")])]),a._v(" "),t("li",[t("p",[a._v("改用WebSocket通信，无跨域限制")])]),a._v(" "),t("li",[t("p",[a._v("同源服务端转发")])])]),a._v(" "),t("h3",{attrs:{id:"cookie、localstorage无法读取"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cookie、localstorage无法读取","aria-hidden":"true"}},[a._v("#")]),a._v(" cookie、localStorage无法读取")]),a._v(" "),t("ul",[t("li",[a._v("如果一级域名相同，只是二级或以后的域名不同，可以设置document.domain为相同域名，即可共享cookie和localStorage")])]),a._v(" "),t("h3",{attrs:{id:"iframe的dom内容无法获取"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#iframe的dom内容无法获取","aria-hidden":"true"}},[a._v("#")]),a._v(" iframe的DOM内容无法获取")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("如果一级域名相同，只是二级或以后的域名不同，可以设置document.domain为相同域名，即可通过"),t("code",[a._v('document.getElementById("iframe").contentWindow.document')]),a._v("获取")])]),a._v(" "),t("li",[t("p",[a._v("postMessage和监听message事件完成通信")])])]),a._v(" "),t("h3",{attrs:{id:"外域script标签的错误内容无法被window-onerror捕获"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#外域script标签的错误内容无法被window-onerror捕获","aria-hidden":"true"}},[a._v("#")]),a._v(" 外域script标签的错误内容无法被window.onerror捕获")]),a._v(" "),t("ul",[t("li",[a._v("服务端需要设置"),t("code",[a._v("Access-Control-Allow-Origin")]),a._v("，且script标签需要加上"),t("code",[a._v("crossorigin")]),a._v("属性")])])])},[],!1,null,null,null);r.default=i.exports}}]);